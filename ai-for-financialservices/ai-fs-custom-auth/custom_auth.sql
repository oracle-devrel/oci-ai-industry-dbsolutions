-- Create Sequence
CREATE SEQUENCE  COMMON_USER_SEQ  MINVALUE 1 MAXVALUE 9999999999999999999999999999 
INCREMENT BY 1 START WITH 841 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;

-- Create table common role
 CREATE TABLE "COMMON_ROLE" 
   (	
    "ROLE_ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 
    INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"ROLE_NAME" VARCHAR2(255 CHAR) NOT NULL ENABLE, 
	"ROLE_DESC" VARCHAR2(1000 CHAR), 
	 CONSTRAINT "COMMON_ROLE_PK" PRIMARY KEY ("ROLE_ID")
  USING INDEX  ENABLE
   ) ;

-- Create table common users 
CREATE TABLE "COMMON_USERS" 
   (	
    "USER_ID" NUMBER NOT NULL ENABLE, 
	"EMAIL" VARCHAR2(255), 
	"PASSWORD" VARCHAR2(2000), 
	"VERIFICATION_CODE" VARCHAR2(255), 
	"ROLE_ID" NUMBER, 
	"REFER_URL" VARCHAR2(1000), 
	"REFER_USER_ID" NUMBER, 
	"POINTS" NUMBER, 
	"FIRST_NAME" VARCHAR2(100), 
	"LAST_NAME" VARCHAR2(100), 
	"ADDRESS1" VARCHAR2(255), 
	"ADDRESS2" VARCHAR2(255), 
	"CITY" VARCHAR2(100), 
	"STATEZIP" VARCHAR2(100), 
	"ANSWER" VARCHAR2(50), 
	"COUNTRY" VARCHAR2(20), 
	"GENDER" VARCHAR2(10),  
	 CONSTRAINT "COMMON_USER_PK" PRIMARY KEY ("USER_ID")
  USING INDEX  ENABLE
   ) ;

  ALTER TABLE "COMMON_USERS" ADD CONSTRAINT "COMMON_USERS_FK" FOREIGN KEY ("ROLE_ID")  REFERENCES "COMMON_ROLE" ("ROLE_ID") ENABLE;
 
  CREATE OR REPLACE EDITIONABLE TRIGGER "BI_COMMON_USERS" 
  before insert on "COMMON_USERS"                
    for each row   
    begin    
        if :NEW."USER_ID" is null then  
            select "COMMON_USER_SEQ".nextval into :NEW."USER_ID" from sys.dual;  
        end if;  
    end;  
  
ALTER TRIGGER "BI_COMMON_USERS" ENABLE;

---- Insert Sample Roles ------------

DELETE from COMMON_ROLE;

INSERT ALL
      INTO COMMON_ROLE (role_id, role_name, role_desc) values (1, 'Administrator', 'Administrator with full access')
      INTO COMMON_ROLE (role_id, role_name, role_desc) values (2, 'Customer', 'Bank Customer')
      INTO COMMON_ROLE (role_id, role_name, role_desc) values (3, 'Doctor', 'Doctor in AI for Healthcare')
      INTO COMMON_ROLE (role_id, role_name, role_desc) values (4, 'User', 'Common User')
      INTO COMMON_ROLE (role_id, role_name, role_desc) values (5, 'Banker', 'Bank Officer in AI for Financial Services')
SELECT * FROM dual;

---- Insert Sample Users ------------

INSERT ALL 
    INTO COMMON_USERS (EMAIL, PASSWORD, ANSWER,) VALUES ('DEMOUSER', 'ECD3722B93FFCD6C4CD35AA07B564535', 'red')
    INTO COMMON_USERS (EMAIL, PASSWORD, ANSWER) VALUES ('Doctor3', 'FB93144A6A2839461D86974D5CE69D8A', 'red')
    INTO COMMON_USERS (EMAIL, PASSWORD, ANSWER) VALUES ('Doctor2', 'FB93144A6A2839461D86974D5CE69D8A', 'red')
    INTO COMMON_USERS (EMAIL, PASSWORD, ANSWER) VALUES ('Patient1', 'FB93144A6A2839461D86974D5CE69D8A', 'red')
    INTO COMMON_USERS (EMAIL, PASSWORD, ANSWER) VALUES ('Patient2', 'FB93144A6A2839461D86974D5CE69D8A', 'red')
    INTO COMMON_USERS (EMAIL, PASSWORD, ANSWER) VALUES ('BANKER', 'DAAEF850E4310C419C6284DA827D1C8B', 'red')
SELECT * FROM dual;